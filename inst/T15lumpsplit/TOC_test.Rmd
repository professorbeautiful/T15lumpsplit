---
title: "TOC_test"
author: "Roger Day"
date: "7/26/2021"
resource_files:
- www/zoomAdvice.Rmd
- www/zoom_triggers.js
- www/readInnerWindow.js
- www/the-delta-method.pdf
- www/BayesEquation.Rmd
runtime: shiny
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: no
      smooth_scroll: no
---


\[
\newcommand{\mylarge}[1] {\large{#1}\normalsize}
\newcommand{\mynormal}[1] {{\normalsize{#1}}}
\]

# title 1

# title 2

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE)
options(knitr.duplicate.label = 'allow')
```


```{r shinyjs, context="server", echo=FALSE, include=TRUE}

#shiny::addResourcePath("shinyjs", system.file("srcjs", package = "shinyjs"))
#library(shinyjs)
shinyjs::useShinyjs(html = TRUE)
require(shinyjs)
shinyjs::useShinyjs(rmd=TRUE, html=TRUE, debug=TRUE)
#<script src="shinyjs/inject.js"></script>

saveEntriesJScode =  
  "shinyjs.saveEntriesJS = function() {document.getElementById('downloadAllUserEntries').click();};"
helloJScode = 
  "shinyjs.helloJS = function() {alert('HELLO');};"
shinyjs::extendShinyjs(text = saveEntriesJScode, functions=c('saveEntriesJS'))
```



```{r include = FALSE}
#  options(error=utils::recover)  # I wish this helped!

user = system('echo $USER', intern = TRUE) # for saving&retrieving files.

require(T15lumpsplit)
require(shiny)
require(xtable)

require(devtools)
if(!require(T15lumpsplit))
  devtools::install_github('professorbeautiful/T15lumpsplit')
if(!require(shinyDebuggingPanel))
  devtools::install_github('professorbeautiful/shinyDebuggingPanel')
require(magrittr);require(shinyBS)
require(knitr);require(rmarkdown);

if(interactive()) {  ### Running out of RStudio locally
  analysisReactiveSetup_DTC = paste0('inst/T15lumpsplit/', 'analysisReactiveSetup_DTC.R')
  analysisReactiveSetup_BDC = paste0('inst/T15lumpsplit/', 'analysisReactiveSetup_BDC.R')
} else  { ### Running at shinyapps.io
  analysisReactiveSetup_DTC =  'analysisReactiveSetup_DTC.R'
  analysisReactiveSetup_BDC =  'analysisReactiveSetup_BDC.R'
}
```

```{r setup numbering, warning=FALSE}
if(exists(x = 'envNumberSequences')) {
  rm(list=ls(envir = envNumberSequences), envir = envNumberSequences)
} else
  envNumberSequences = new.env()
### Note that the .GlobalEnv seen here is different from your R session... and it persists across Rmd runs!

source('initializations.R', local=TRUE)
```
# title 3


```{r colors}
adviceForeground = 'darkred'
adviceBackground = 'snow'
lumpColor = 'red'
splitColor = 'blue'

## https://www.w3schools.com/cssref/css_colors.asp
```

```{r onStop}
#onStop(function() {
   #cat("Doing application cleanup\n")
#})
# Wish it worked.
```

```{r}
#alert('GETTINGSTARTED')  // This works!
includeScript('www/onbeforeunload.js')   ### Not doing anything now?
```




```{r initial values, echo=FALSE}

logit <<- function(p) log(p/(1-p))
antilogit <<- function(x) 1 - 1/(1+exp(x))
DLdataOriginal = matrix(c(3,3,4,90),nrow=2)
dimnames(DLdataOriginal) = list( outcome=c("R","N"), feature=c("D","L"))
ColorForPrior="orange";     
ColorForPosterior="blue";     
ColorForLikelihood="black"
TOCnum =  0
```

```{r servercode}
DLdata = list()
rValues = reactiveValues(tau = 1,  phi = 0.001, mu=0.5,
                         title_1='title 1',
                         #DLdata=list(),
                         #DLdataMyChoice=list(),
                         #DLdataLastUsed = DLdataOriginal,
                         isResetting = FALSE,
                         isLoopingSync = FALSE,
                         WhoPriorProbProb = 1/2,
                         WhoPriorOdds = 1, #,
                         #thisSession = session
                         qStar = 1
)
```


```{r sessioninitialized}
#### This doesn't work in Rmarkdown.
invisible(
  tags$head(tags$script(
    "$(document).on('shiny:sessioninitialized',
    function(event) {
    alert('shiny:sessioninitialized  2');
    Shiny.onInputChange('sessioninitialized2', 2)
});"
  )) 
)
```


```{r shiny:connected}
### this doesn't work either.
invisible(
  tags$head(tags$script(
    "$(document).on('shiny:connected', 
  function(event) {
    alert('shiny:connected  2');
    Shiny.onInputChange('shinyconnected2', 2)
  });"
  )) 
)
```


```{r makeDebuggingPanelOutput}
observeEvent(input$ctrlDpressed, {}) # just to flush the ctrl-D press.

shinyDebuggingPanel::makeDebuggingPanelOutput(
   session, toolsInitialState = TRUE,
   condition='ctrlDpressed === true')


#options(shiny.trace=TRUE)
```

```{r fat arrow, results='asis'}
#cat("\U2B07")
# This shows you can get a fat arrow... but not in a plot.
```

```{r zoomRange}
    #### zoomAdvice ####
zoomRange <<- c(1200, 1400)
```

```{r zoomAdvice}
invisible(inclRmd('www/zoomAdvice.Rmd'))
```


```{r browserAdvice}
invisible(inclRmd('www/browserAdvice.Rmd'))
```

```{r contentsAdvice}
invisible(inclRmd('www/contentsAdvice.Rmd'))
```

```{r in-progress}
h3("NOTE: this is a work in progress!")
```

<a name='section-debugging'> </a>

```{r withDebuggingPanel}
fluidRow(
shinyDebuggingPanel::withDebuggingPanel()
)
```


```{r}
includeScript('www/KeyHandler.js')
includeScript('navigateToId.js')   ### ESCAPE key to return.  
###The Chrome problem is NOT:
# the order of these includeScripts.
# due to navigateY. That works in JS console.

includeCSS('TOC.css')    
### includeCSS doesn't work early on.
### It worksin the YAML.
includeCSS('lumpsplit.css')
# includeScript('www/jquery-3.3.1.min.js')
####
```


```{r UI_begins}
require(shinyBS)
```
*Package:T15lumpsplit  `r packageVersion('T15lumpsplit')`  `r packageDate('T15lumpsplit')`     Author: Roger Day, University of Pittsburgh*


# OVERVIEW of this Module  <!-- #title -->


## Contents of this Module  <!-- #title -->

```{r Overview-topic}
conditionalPanelWithCheckbox(
  labelString = 'Overview of the topic', 
  filename = 'Overview.Rmd', 
  initialValue = TRUE)
```

For a refresher on the concepts of bias, variance, and mean squared error in estimation, open this panel.

```{r bias-variance-meansquarederror-MSE.pdf}
conditionalPanelWithCheckboxPDF(labelString='Concepts: bias, variance, and mean squared error in estimation',
     filename="bias-variance-meansquarederror-MSE.pdf",
     cbStringId='cbStringIdBiasVariance')
```

The general scope of the bias-variance axis in many settings is here:

```{r biasVariancePicture}
#### THIS WORKS. In the Preview window, iframe is turned into external to Preview  app. but not from the browser, that's OK. ####

#### bias-variance axis ####
conditionalPanelWithCheckboxPDF(labelString='The bias-variance axis',
     filename="Reproducibility-lump-split-page-1.pdf",
     cbStringId='cbStringIdReproducibility')

```

## Tips on using this Module  <!-- #title -->




```{r Overview-editing}
conditionalPanelWithCheckbox(
  labelString = 'ADVICE on editing data', 
  filename = 'dataEditingAdvice.Rmd', 
  initialValue = FALSE)
```

```{r Overview-saving-retrieving}
conditionalPanelWithCheckbox(
  labelString = 'ADVICE on saving and retrieving your answers questions and comments', 
  filename = 'contentsAdvice.Rmd', 
  initialValue = FALSE)
```


```{r listings}
# ls()
# cat('-=-=-=-=\n')
# ls(pos=1)
# cat('-=-=-=-=\n')
# so it has its own .GlobalEnv, and it's persistent across knits.
# wrapperToGetKeys  ### interesting! that's mine! from DebugTools
```



# "Lumping" versus "splitting" in science. <!-- #title -->


In science, advances often proceed by "splitting": things that seem initially the same are classified as different. The classification may be tentativedistinction, until it proves to be useful. 
Other advances proceed by "lumping":  identifying things that seem different but have a deep connection.

So, we split birds and bats, but we lump bats and whales because they are both mammals. At least in this case, for some purposes, lumping supercedes splitting.
(But if studying modes of  locomotion, the lumping will be different.)

In medicine both splitting and lumping are important.

Cancer was just "cancer" before it was learned through clinical trials that some medicines work well on cancer in one organ but not another--- and vice versa for another medicine.

In recent years, however, specific molecular defects in cancer cells have "lumped" together types of cancer that we would not have dreamed of connecting.
The drug gleevec is a miracle drug for patients with chronic myelogenous leukemia (CML). But not for other leukemias. Deep insight into molecular biology of cancer showed that a radically different kind, gastrointestinal stromal tumor (GIST). 
Better lumping together with better splitting can cure cancer patients.

We will explore a simple lumping and splitting conundrum as a jumping off point for introducing a collection of important statistical ideas that connect to each other.

# TO HERE 327 -- NO jquery-3.3.1.min.js


